app.controller('BlogController',['$scope','BlogService','$location','$rootScope','$cookieStore','$http',
	function($scope, BlogService, $location, $rootScope,$cookieStore, $http) {
	console.log("Inside blogController")
	this.blog={
		id : '',
		blogid : '',
		title : '',
		description : '',
		datetime : '',
		reason : '',
		status : ''
	}
	this.blogs=[];
	this.getBlog = function() {
		console.log("Inside getblog function of blogController");
		BlogService.getBlogById($scope.blogid)
		.then(
				function(d) {
					$rootScope.currentblog=d;
					$location.path("/viewBlog")
				},
				function(errResponse) {
					console.error('Error while getting blog');
				});
	};
	this.createBlog = function(blog) {
		console.log("Inside createblog function of blogController");
		BlogService.createBlog(blog)
		.then(
				function(d) {
					$location.path("/blog")
				},
				function(errResponse) {
					console.error('Error while creating blog');
				});
	};
	this.create = function() {
		{
		console.log("Submit blog",this.blog);
		this.createBlog(this.blog);
		}
		
	
	};
	this.updateBlog = function(blog) {
		console.log("updateBlog!")
		this.blog.id=$rootScope.blog.blogid
		BlogService.updateBlog(blog)
		.then(
				function(d) 
				{
					this.blog=d;
					if(this.blog.errorCode==200)
					{
						alert("Thank You Blog Updated Successfully!!!")
						$location.path("/")
					}
					else if(this.blog.errorCode==400)
					{
						alert("User Not Logged In Please Log In First To Update Blog")
						$location.path("/login")
					}
					else if(this.blog.errorCode==404)
					{
						alert("Error Updating Blog Please Try Again")
						$location.path("/editBlog")
					}
					else if(this.blog.errorCode==500)
					{
						alert("This Blog Is Not Created By You So You Cannot Update This Blog")
						$location.path("/")
					}
					
				},
				function(errResponse) 
				{
						console.error('Error while updating Blog.');
			});
		};
	this.fetchBlogById = function(blog) {
		console.log("fetchBlogById!")
		BlogService.fetchBlogById(blog)
		.then(
				function(d) 
				{
					this.blog=d;
					$rootScope.blog=d;
					console.log(this.blog)
					alert("Thank You Blog Fetched Successfully!!!")
					$location.path("/displayBlogById")
				},
				function(errResponse) 
				{
						console.error('Error while fetching Blog.');
			});
		};

	
	this.fetchAllBlogs = function() {
		console.log("fetchAllBlogs!")
		BlogService.fetchAllBlogs()
		.then(
				function(d) 
				{
					this.blogs=d;
					if(this.blogs.length==0)
					{
						alert("There Are No Blogs To Display")
					}
					$rootScope.blogs=d;
					console.log(this.blogs)
					alert("Thank You Blogs Fetched Successfully!!!")
					$location.path('/displayblog')
				},
				function(errResponse) 
				{
						console.error('Error while Fetching Blogs.');
			});
		};	
		this.display = function() {
			{
				console.log('Display All Blog');
				this.fetchAllBlogs();
			}
		};
			


	
	

	
	


	
	

}])
	